---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: vh-testing
  namespace: vh
  annotations:
    fluxcd.io/automated: "true"
    filter.fluxcd.io/tag.nodejs: glob:prod-*
spec:
  releaseName: vh-testing
  chart:
    git: git@github.com:hmcts/vh-testing
    path: charts/vh-testing
    ref: master
  values:
    java:
      replicas: 1
      useInterpodAntiAffinity: false
      image: sdshmctspublic.azurecr.io/vh/bash:latest
      applicationPort: 80
      ingressHost: vh-testing.platform.hmcts.net
      releaseNameOverride: vh-testing
      aadIdentityName: vh-aad-identity
      keyVaults:
        vh-infra-core:
          excludeEnvironmentSuffix: false
          resourceGroup: vh-infra-core-{{ .Values.global.environment }}
          usePodIdentity: true
          secrets:
            - vh-user-api-key
            - vh-user-api-appid
            - vh-user-api-identifieruris
            - vh-infra-core-AppInsightsKey
            - defaultpassword
            - redis-connection-str
            - testdefaultpassword

