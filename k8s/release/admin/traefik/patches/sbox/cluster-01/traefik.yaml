apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: traefik
  namespace: admin
spec:
  # valueFileSecrets:
  #   - name: "traefik-values"
  values:
    loadBalancerIP: 10.140.31.250
    dashboard:
      domain: traefik01.ss-service.core-compute-sandbox.internal
    accessLogs:
      enabled: true
    autoscaling:
      minReplicas: 1
      maxReplicas: 2
    service:
      annotations:
        service.beta.kubernetes.io/azure-load-balancer-resource-group: aks-infra-sbox-rg
    ssl:
      generateTLS: true
      defaultCN: "*.ss-service.core-compute-sandbox.internal"
    metrics:
      prometheus:
        enabled: true
        buckets: [0.1,0.3,1.2,5]
        service:
          # Set a custom service name
          name:
            traefik-metrics
          annotations:
            prometheus.io/scrape: "true"
          port: 9100
          type: ClusterIP
    deployment:
      podAnnotations:
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
